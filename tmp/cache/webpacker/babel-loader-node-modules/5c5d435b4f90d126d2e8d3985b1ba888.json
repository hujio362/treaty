{"ast":null,"code":"var _require = require(\"@rails/ujs\"),\n    $ = _require.$;\n\nvar pay = function pay() {\n  Payjp.setPublicKey(\"pk_test_9af729190b04774872fc6ed9\");\n  var form = document.getElementById(\"charge-form\");\n  console.log(form);\n  form.addEventListener(\"submit\", function (e) {\n    e.preventDefault();\n    var formResult = document.getElementById(\"charge-form\");\n    console.log(formResult);\n    var formData = new FormData(formResult);\n    var card = {\n      number: formData.get(\"user_order[number]\"),\n      cvc: formData.get(\"user_order[cvc]\"),\n      exp_month: formData.get(\"user_order[exp_month]\"),\n      exp_year: \"20\".concat(formData.get(\"user_order[exp_year]\"))\n    };\n    console.log(card);\n    Payjp.createToken(card, function (status, response) {\n      console.log(status);\n      console.log(response);\n\n      if (status == 200) {\n        var token = response.id;\n        var renderDom = document.getElementById('charge-form');\n        console.log(renderDom);\n        var tokenObj = \"<input value=\".concat(token, \" name='token' type=\\\"hidden>\");\n        renderDom.insertAdjacentHTML(\"beforeend\", tokenObj);\n      }\n\n      document.getElementById(\"number\").removeAttribute(\"name\");\n      document.getElementById(\"cvc\").removeAttribute(\"name\");\n      document.getElementById(\"exp-month\").removeAttribute(\"name\");\n      document.getElementById(\"exp-year\").removeAttribute(\"name\");\n      document.getElementById(\"charge-form\").submit();\n    });\n  });\n};\n\nwindow.addEventListener(\"load\", pay);","map":{"version":3,"sources":["/Users/shuka/projects/furima-28198/app/javascript/card.js"],"names":["require","$","pay","Payjp","setPublicKey","form","document","getElementById","console","log","addEventListener","e","preventDefault","formResult","formData","FormData","card","number","get","cvc","exp_month","exp_year","createToken","status","response","token","id","renderDom","tokenObj","insertAdjacentHTML","removeAttribute","submit","window"],"mappings":"eAAcA,OAAO,CAAC,YAAD,C;IAAbC,C,YAAAA,C;;AAER,IAAMC,GAAG,GAAG,SAANA,GAAM,GAAM;AAChBC,EAAAA,KAAK,CAACC,YAAN,CAAmB,kCAAnB;AACA,MAAMC,IAAI,GAAGC,QAAQ,CAACC,cAAT,CAAwB,aAAxB,CAAb;AACAC,EAAAA,OAAO,CAACC,GAAR,CAAYJ,IAAZ;AACAA,EAAAA,IAAI,CAACK,gBAAL,CAAsB,QAAtB,EAAgC,UAACC,CAAD,EAAO;AACrCA,IAAAA,CAAC,CAACC,cAAF;AAEE,QAAMC,UAAU,GAAGP,QAAQ,CAACC,cAAT,CAAwB,aAAxB,CAAnB;AACAC,IAAAA,OAAO,CAACC,GAAR,CAAYI,UAAZ;AACA,QAAMC,QAAQ,GAAG,IAAIC,QAAJ,CAAaF,UAAb,CAAjB;AAEA,QAAMG,IAAI,GAAG;AACXC,MAAAA,MAAM,EAAEH,QAAQ,CAACI,GAAT,CAAa,oBAAb,CADG;AAEXC,MAAAA,GAAG,EAAEL,QAAQ,CAACI,GAAT,CAAa,iBAAb,CAFM;AAGXE,MAAAA,SAAS,EAAEN,QAAQ,CAACI,GAAT,CAAa,uBAAb,CAHA;AAIXG,MAAAA,QAAQ,cAAOP,QAAQ,CAACI,GAAT,CAAa,sBAAb,CAAP;AAJG,KAAb;AAMAV,IAAAA,OAAO,CAACC,GAAR,CAAYO,IAAZ;AACAb,IAAAA,KAAK,CAACmB,WAAN,CAAkBN,IAAlB,EAAwB,UAACO,MAAD,EAASC,QAAT,EAAsB;AAC5ChB,MAAAA,OAAO,CAACC,GAAR,CAAYc,MAAZ;AACAf,MAAAA,OAAO,CAACC,GAAR,CAAYe,QAAZ;;AACA,UAAID,MAAM,IAAI,GAAd,EAAmB;AACjB,YAAME,KAAK,GAAGD,QAAQ,CAACE,EAAvB;AACA,YAAMC,SAAS,GAAGrB,QAAQ,CAACC,cAAT,CAAwB,aAAxB,CAAlB;AACAC,QAAAA,OAAO,CAACC,GAAR,CAAYkB,SAAZ;AACA,YAAMC,QAAQ,0BAAmBH,KAAnB,iCAAd;AACAE,QAAAA,SAAS,CAACE,kBAAV,CAA6B,WAA7B,EAA0CD,QAA1C;AACD;;AAEDtB,MAAAA,QAAQ,CAACC,cAAT,CAAwB,QAAxB,EAAkCuB,eAAlC,CAAkD,MAAlD;AACAxB,MAAAA,QAAQ,CAACC,cAAT,CAAwB,KAAxB,EAA+BuB,eAA/B,CAA+C,MAA/C;AACAxB,MAAAA,QAAQ,CAACC,cAAT,CAAwB,WAAxB,EAAqCuB,eAArC,CAAqD,MAArD;AACAxB,MAAAA,QAAQ,CAACC,cAAT,CAAwB,UAAxB,EAAoCuB,eAApC,CAAoD,MAApD;AAEAxB,MAAAA,QAAQ,CAACC,cAAT,CAAwB,aAAxB,EAAuCwB,MAAvC;AACD,KAjBD;AAkBH,GAhCD;AAiCD,CArCD;;AAuCAC,MAAM,CAACtB,gBAAP,CAAwB,MAAxB,EAAgCR,GAAhC","sourcesContent":["const { $ } = require(\"@rails/ujs\");\n\nconst pay = () => {\n  Payjp.setPublicKey(\"pk_test_9af729190b04774872fc6ed9\");\n  const form = document.getElementById(\"charge-form\");\n  console.log(form)\n  form.addEventListener(\"submit\", (e) => {\n    e.preventDefault();\n\n      const formResult = document.getElementById(\"charge-form\");\n      console.log(formResult)\n      const formData = new FormData(formResult);\n\n      const card = {\n        number: formData.get(\"user_order[number]\"),\n        cvc: formData.get(\"user_order[cvc]\"),\n        exp_month: formData.get(\"user_order[exp_month]\"),\n        exp_year: `20${formData.get(\"user_order[exp_year]\")}`,\n      };\n      console.log(card)\n      Payjp.createToken(card, (status, response) => {\n        console.log(status)\n        console.log(response)\n        if (status == 200) {\n          const token = response.id;\n          const renderDom = document.getElementById('charge-form');\n          console.log(renderDom)\n          const tokenObj = `<input value=${token} name='token' type=\"hidden>`;\n          renderDom.insertAdjacentHTML(\"beforeend\", tokenObj);\n        }\n\n        document.getElementById(\"number\").removeAttribute(\"name\");\n        document.getElementById(\"cvc\").removeAttribute(\"name\");\n        document.getElementById(\"exp-month\").removeAttribute(\"name\");\n        document.getElementById(\"exp-year\").removeAttribute(\"name\");\n\n        document.getElementById(\"charge-form\").submit();\n      })\n  });\n};\n\nwindow.addEventListener(\"load\", pay);"]},"metadata":{},"sourceType":"module"}